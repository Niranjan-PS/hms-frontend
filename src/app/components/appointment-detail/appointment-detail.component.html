<div class="container">
  <h2>Appointment Details</h2>
  <div *ngIf="success" class="success">{{ success }}</div>
  <div *ngIf="error" class="error">{{ error }}</div>
  <div *ngIf="appointment">
    <p><strong>Patient:</strong> {{ appointment.patient.name }}</p>
    <p><strong>Doctor:</strong> {{ appointment.doctor.user.name }}</p>
    <p><strong>Status:</strong> {{ appointment.status }}</p>
    <form [formGroup]="appointmentForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="date">Date and Time:</label>
        <input id="date" formControlName="date" type="datetime-local" required />
        <div *ngIf="appointmentForm.get('date')?.invalid && appointmentForm.get('date')?.touched" class="error">
          Date and time are required
        </div>
      </div>
      <div class="form-group">
        <label for="reason">Reason:</label>
        <textarea id="reason" formControlName="reason" required></textarea>
        <div *ngIf="appointmentForm.get('reason')?.invalid && appointmentForm.get('reason')?.touched" class="error">
          Reason is required
        </div>
      </div>
      <div class="form-group" *ngIf="isDoctor || isAdmin">
        <label for="status">Status:</label>
        <select id="status" formControlName="status">
          <option value="pending">Pending</option>
          <option value="confirmed">Confirmed</option>
          <option value="completed">Completed</option>
          <option value="cancelled">Cancelled</option>
        </select>
      </div>
      <button type="submit" [disabled]="appointmentForm.invalid">Update Appointment</button>
      <button type="button" (click)="cancelAppointment()" *ngIf="appointment.status !== 'cancelled'">
        Cancel Appointment
      </button>
    </form>
  </div>
</div>